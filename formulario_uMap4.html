<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de CSV para uMap</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        form { margin-bottom: 20px; }
        label { display: block; margin-top: 10px; }
        input { padding: 5px; width: 100%; max-width: 400px; }
        button { margin-top: 10px; padding: 8px 12px; cursor: pointer; }
    </style>
</head>
<body>
    <h2>Formulario para un mapa Colectivo</h2>
    <form id="dataForm">
        <label>Nombre: <input type="text" id="name" required></label>
        <label>Descripci√≥n: <input type="text" id="description"></label>
        <label>Latitud: <input type="text" id="latitude" required></label>
        <label>Longitud: <input type="text" id="longitude" required></label>
        <label>Imagen (URL): <input type="text" id="image"></label>
        <label>Audio (URL): <input type="text" id="audio"></label>
        <label>Enlace extra: <input type="text" id="link"></label>
        <button type="button" onclick="addData()">Agregar Punto</button>
    </form>
    <button onclick="downloadCSV()">Descargar CSV</button>
    <script>
        let data = [['name', 'description', 'latitude', 'longitude']];
        
        function addData() {
            let name = document.getElementById("name").value;
            let description = document.getElementById("description").value;
            let latitude = document.getElementById("latitude").value;
            let longitude = document.getElementById("longitude").value;
            let image = document.getElementById("image").value;
            let link = document.getElementById("link").value;
            let audio = document.getElementById("audio").value;
            
            let formattedDescription = description;
            if (image) {
                formattedDescription += ` {{${image}|440}}`;
            }
            if (audio) {
                formattedDescription += ` [[${audio}]]`;
            }
            if (link) {
                formattedDescription += ` [[${link}]]`;
            }
            
            if (name && latitude && longitude) {
                data.push([name, formattedDescription, latitude, longitude]);
                alert("Punto agregado correctamente");
            } else {
                alert("Por favor, completa los campos requeridos");
            }
        }
        
        function downloadCSV() {
            let csvContent = "data:text/csv;charset=utf-8," + data.map(e => e.join(",")).join("\n");
            let encodedUri = encodeURI(csvContent);
            let link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "puntos_umap.csv");
            document.body.appendChild(link);
            link.click();
        }
    </script>
</body>
</html>
